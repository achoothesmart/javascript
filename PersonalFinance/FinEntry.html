<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinEntry</title>
    <style>
        .entry-group input{
            padding: .5em;
            margin: .25em;
            cursor: pointer;
        }

        .total-row{
            font-weight: bold;
        }

        .hint{
            font-size: smaller;
        }
    </style>
    
</head>
<body>
    <table>
        <tr>
            <td>
                <div class="entry-group">
                    <input type="text" id="particular" placeholder="Particular"/>
                    <br/>
                    <input type="number" id="amount" placeholder="Amount"/>
                    <br/>
                    <input type="radio" id="entry_type_debit" name="entry_type" value="debit"/> Debit
                    <input type="radio" id="entry_type_credit" name="entry_type" value="credit"/> Credit
                    <br/>
                    <input type="button" value="Add Entry" onclick="addTrans()"/>
                </div>
            </td>

            <td>
                <h3>Bulg Import</h3>
                <div>Format: <i> [Particular] _tab_ [d/c] _tab_ [Amount] </i> </div>
                
                <div>
                    <textarea rows="10" cols="50"></textarea>
                </div>
            </td>

            <td>
                <div class="hint">Credit Transaction Example: <i>Salary c 54000</i></div>
                <div class="hint">Credit Transaction Example: <i>Rent d 10000</i></div>
                <div class="hint">Debit value d is default. All transactions without mentioning 'd' will be treated as bebit</div>
                <br/>
                <input type="button" value="Import"/>
            </td>
        </tr>
    </table>
    
    

    <div id="all_transactions">

    </div>
    
    <script>
        let lst_trans = [
            { particular: 'Salary', amount: 50000.00, type: 'credit' },
            { particular: 'Maligai', amount: 2500.00, type: 'debit' },
            { particular: 'Rent', amount: 10000.00, type: 'debit' }
        ];

        loadTransactions();

        function addTrans(){
            if(!validateEntry()){
                return;
            }
            lst_trans.push({
                particular: particular.value,
                amount: Number.parseFloat(amount.value),
                type: Array.from(document.getElementsByName('entry_type')).filter(el=>el.checked)[0].value
            });
            clearEntry();
            loadTransactions();
            console.log(lst_trans);
        }

        function validateEntry(){
            return particular.value.trim() != '' && amount.value.trim() != '';
        }

        function clearEntry(){
            particular.value = '';
            amount.value = '';
            entry_type_credit.checked = false;
            entry_type_debit.checked = false;
        }

        function getTotal(){
            let total = 0;
            total += lst_trans.filter(tran => tran.type == 'credit').map(cred_tran => cred_tran.amount).reduce((a,b)=> a+b, 0)
            total -= lst_trans.filter(tran => tran.type == 'debit').map(debt_tran => debt_tran.amount).reduce((a,b)=> a+b, 0)
            return total;
        }

        function loadTransactions(){
            let html = '<table border="1">';
            html += '<tr> <th>Particular</th> <th>Debit (INR)</th> <th>Credit (INR)</th> </tr>';
            html += lst_trans.map(tran => 
                `<tr> 
                    <td>${tran.particular}</td> 
                    <td>${tran.type == 'debit' ? tran.amount : 0}</td> 
                    <td>${tran.type == 'credit' ? tran.amount : 0}</td> 
                </tr>`
            ).join(' ');
            html += `<tr class='total-row'> <td>Total</td> <td colspan='2'>${getTotal()}</td>  </tr>`;
            html += '</table>';
            all_transactions.innerHTML = html;
        }
    </script>
</body>
</html>